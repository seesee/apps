<!doctype html><html lang="en"><head><meta charset="UTF-8"><title>Templatimator</title><meta name="viewport" content="width=device-width,initial-scale=1"><style>:root{--color-primary:#3b82f6;--color-primary-hover:#2563eb;--color-primary-light:#eff6ff;--color-secondary:#64748b;--color-success:#10b981;--color-danger:#ef4444;--color-warning:#f59e0b;--color-white:#ffffff;--color-gray-50:#f8fafc;--color-gray-100:#f1f5f9;--color-gray-200:#e2e8f0;--color-gray-300:#cbd5e1;--color-gray-400:#94a3b8;--color-gray-500:#64748b;--color-gray-600:#475569;--color-gray-700:#334155;--color-gray-800:#1e293b;--color-gray-900:#0f172a;--font-sans:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;--font-mono:"SF Mono",Monaco,"Cascadia Code","Roboto Mono",Consolas,"Courier New",monospace;--space-1:0.25rem;--space-2:0.5rem;--space-3:0.75rem;--space-4:1rem;--space-5:1.25rem;--space-6:1.5rem;--space-8:2rem;--space-10:2.5rem;--space-12:3rem;--space-16:4rem;--radius-sm:0.375rem;--radius-md:0.5rem;--radius-lg:0.75rem;--radius-xl:1rem;--shadow-sm:0 1px 2px 0 rgba(0, 0, 0, 0.05);--shadow-md:0 4px 6px -1px rgba(0, 0, 0, 0.1),0 2px 4px -1px rgba(0, 0, 0, 0.06);--shadow-lg:0 10px 15px -3px rgba(0, 0, 0, 0.1),0 4px 6px -2px rgba(0, 0, 0, 0.05);--shadow-xl:0 20px 25px -5px rgba(0, 0, 0, 0.1),0 10px 10px -5px rgba(0, 0, 0, 0.04);--transition-fast:150ms ease-in-out;--transition-base:200ms ease-in-out;--transition-slow:300ms ease-in-out}*{box-sizing:border-box}body,html{font-family:var(--font-sans);background:var(--color-gray-50);margin:0;padding:0;color:var(--color-gray-900);line-height:1.6;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.container{max-width:1400px;margin:var(--space-8) auto;background:var(--color-white);border-radius:var(--radius-xl);box-shadow:var(--shadow-lg);padding:var(--space-10);border:1px solid var(--color-gray-200)}h1{margin:0 0 var(--space-8) 0;font-size:2.25rem;font-weight:700;color:var(--color-gray-900);letter-spacing:-.025em;background:linear-gradient(135deg,var(--color-primary),var(--color-primary-hover));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.flex{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:var(--space-6);margin-bottom:var(--space-8)}.col{display:flex;flex-direction:column;gap:var(--space-4);background:var(--color-gray-50);padding:var(--space-6);border-radius:var(--radius-lg);border:1px solid var(--color-gray-200);animation:.5s ease-out fadeIn}label{font-weight:600;font-size:.875rem;color:var(--color-gray-700);margin-bottom:var(--space-2);text-transform:uppercase;letter-spacing:.05em}input,select,textarea{width:100%;font-size:.875rem;padding:var(--space-3);border:1px solid var(--color-gray-300);border-radius:var(--radius-md);background:var(--color-white);transition:all var(--transition-base);font-family:inherit;color:var(--color-gray-900)}input:focus,select:focus,textarea:focus{outline:0;border-color:var(--color-primary);box-shadow:0 0 0 3px var(--color-primary-light)}input:hover,select:hover,textarea:hover{border-color:var(--color-gray-400)}textarea{min-height:120px;font-family:var(--font-mono);font-size:.8125rem;line-height:1.5;resize:vertical}input::placeholder,textarea::placeholder{color:var(--color-gray-400)}select{cursor:pointer;appearance:none;background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");background-position:right var(--space-3) center;background-repeat:no-repeat;background-size:1rem;padding-right:var(--space-10)}.output-area{background:var(--color-white);border:1px solid var(--color-gray-300);border-radius:var(--radius-lg);padding:var(--space-6);min-height:200px;overflow-x:auto;font-family:var(--font-mono);font-size:.8125rem;line-height:1.6;white-space:pre-wrap;word-break:break-word;box-shadow:var(--shadow-sm)}.btn{display:inline-flex;align-items:center;justify-content:center;background:var(--color-primary);color:var(--color-white);border:none;border-radius:var(--radius-md);padding:var(--space-3) var(--space-5);font-size:.875rem;font-weight:600;cursor:pointer;transition:all var(--transition-base);text-decoration:none;white-space:nowrap;box-shadow:var(--shadow-sm)}.btn:hover{background:var(--color-primary-hover);transform:translateY(-1px);box-shadow:var(--shadow-md)}.btn:active{transform:translateY(0);box-shadow:var(--shadow-sm)}.btn:focus{outline:0;box-shadow:0 0 0 3px var(--color-primary-light)}.btn.secondary{background:var(--color-white);color:var(--color-gray-700);border:1px solid var(--color-gray-300)}.btn.secondary:hover{background:var(--color-gray-50);color:var(--color-gray-900);border-color:var(--color-gray-400)}.btn.flash-success{background:var(--color-success)!important;color:var(--color-white)!important}.btn.flash-fail{background:var(--color-danger)!important;color:var(--color-white)!important}.list{margin:0 0 var(--space-4) 0;padding:0;list-style:none;max-height:160px;overflow-y:auto;background:var(--color-white);border:1px solid var(--color-gray-200);border-radius:var(--radius-md);box-shadow:var(--shadow-sm)}.list:empty::after{content:"No items saved yet";display:block;padding:var(--space-4);text-align:center;color:var(--color-gray-400);font-style:italic;font-size:.875rem}.list li{padding:var(--space-3) var(--space-4);cursor:pointer;display:flex;align-items:center;justify-content:space-between;transition:all var(--transition-fast);border-bottom:1px solid var(--color-gray-100);font-size:.875rem}.list li:last-child{border-bottom:none}.list li:hover{background:var(--color-gray-50)}.list li.selected{background:var(--color-primary-light);color:var(--color-primary-hover);font-weight:600}.list li .del{color:var(--color-gray-400);font-size:1rem;cursor:pointer;background:0 0;border:none;padding:var(--space-1);border-radius:var(--radius-sm);transition:all var(--transition-fast);opacity:0}.list li:hover .del{opacity:1}.list li .del:hover{color:var(--color-danger);background:var(--color-gray-100)}.row{display:flex;gap:var(--space-3);align-items:stretch}.row>*{flex:1}.row .btn{flex:0 0 auto;min-width:80px}.output-controls{margin:var(--space-6) 0;padding:var(--space-4);background:var(--color-gray-50);border:1px solid var(--color-gray-200);border-radius:var(--radius-lg);display:flex;gap:var(--space-4);align-items:center;flex-wrap:wrap}.output-controls label{margin:0;font-size:.875rem;color:var(--color-gray-600);text-transform:none;letter-spacing:normal}@media (max-width:768px){.container{margin:var(--space-4);padding:var(--space-6)}.flex{grid-template-columns:1fr}.output-controls{flex-direction:column;align-items:stretch}.output-controls .btn{width:100%}h1{font-size:1.875rem}}@media (max-width:480px){.container{margin:var(--space-2);padding:var(--space-4)}.col{padding:var(--space-4)}.row{flex-direction:column}.row .btn{min-width:auto}}.output-area ol,.output-area ul{margin:var(--space-4) 0 var(--space-4) var(--space-6);padding:0}.output-area li{margin:var(--space-1) 0}.output-area blockquote{border-left:4px solid var(--color-primary);margin:var(--space-4) 0;padding:var(--space-4) var(--space-5);background:var(--color-primary-light);color:var(--color-gray-700);border-radius:0 var(--radius-md) var(--radius-md) 0;font-style:italic}.output-area pre{background:var(--color-gray-100);padding:var(--space-4);border-radius:var(--radius-md);overflow-x:auto;border:1px solid var(--color-gray-200)}.output-area code{background:var(--color-gray-100);color:var(--color-gray-800);padding:var(--space-1) var(--space-2);border-radius:var(--radius-sm);font-size:.85em;font-weight:500}.output-area pre code{background:0 0;padding:0;font-weight:400}.output-area table{border-collapse:collapse;margin:var(--space-4) 0;width:100%;border-radius:var(--radius-md);overflow:hidden;box-shadow:var(--shadow-sm)}.output-area td,.output-area th{border:1px solid var(--color-gray-200);padding:var(--space-3) var(--space-4);text-align:left}.output-area th{background:var(--color-gray-50);font-weight:600;color:var(--color-gray-800)}.output-area tr:nth-child(2n){background:var(--color-gray-50)}.output-area h1,.output-area h2,.output-area h3,.output-area h4,.output-area h5,.output-area h6{margin:var(--space-6) 0 var(--space-3) 0;color:var(--color-gray-900);font-weight:700}.output-area h1{font-size:1.875rem}.output-area h2{font-size:1.5rem}.output-area h3{font-size:1.25rem}.output-area h4{font-size:1.125rem}.output-area h5{font-size:1rem}.output-area h6{font-size:.875rem}.output-area p{margin:var(--space-4) 0;line-height:1.7}.output-area a{color:var(--color-primary);text-decoration:none;font-weight:500}.output-area a:hover{text-decoration:underline}.output-area hr{border:none;height:1px;background:var(--color-gray-300);margin:var(--space-8) 0}@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.col:first-child{animation-delay:.1s}.col:nth-child(2){animation-delay:.2s}.col:nth-child(3){animation-delay:.3s}:focus-visible{outline:2px solid var(--color-primary);outline-offset:2px}.footer{margin-top:var(--space-12);padding-top:var(--space-8);border-top:1px solid var(--color-gray-200)}.footer-content{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:var(--space-4)}.footer-info{display:flex;align-items:center;gap:var(--space-3);flex-wrap:wrap}.app-name{font-weight:700;font-size:1.125rem;color:var(--color-gray-900);background:linear-gradient(135deg,var(--color-primary),var(--color-primary-hover));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.copyright{font-size:.875rem;color:var(--color-gray-600);display:flex;align-items:center;gap:var(--space-1)}.author-link{color:var(--color-gray-700);text-decoration:none;font-weight:600;transition:color var(--transition-base)}.author-link:hover{color:var(--color-primary)}.footer-links{display:flex;align-items:center;gap:var(--space-4)}.github-link{display:inline-flex;align-items:center;gap:var(--space-2);padding:var(--space-2) var(--space-3);background:var(--color-gray-100);border:1px solid var(--color-gray-300);border-radius:var(--radius-md);color:var(--color-gray-700);text-decoration:none;font-size:.875rem;font-weight:500;transition:all var(--transition-base)}.github-link:hover{background:var(--color-gray-900);color:var(--color-white);border-color:var(--color-gray-900);transform:translateY(-1px);box-shadow:var(--shadow-md)}.github-link svg{transition:transform var(--transition-base)}.github-link:hover svg{transform:scale(1.1)}@media (max-width:640px){.footer-content{flex-direction:column;text-align:center;gap:var(--space-4)}.footer-info{flex-direction:column;gap:var(--space-2)}.copyright{flex-wrap:wrap;justify-content:center}}</style></head><body><div class="container"><h1>Templatimator</h1><div class="flex"><div class="col"><label>Templates</label><ul id="templateList" class="list"></ul><div class="row"><input id="templateName" placeholder="Template name"> <button class="btn" onclick="saveTemplate()">Save</button></div><textarea id="templateInput" placeholder="Enter template here..."></textarea></div><div class="col"><label>Key-Value Pairs (JSON or YAML)</label><ul id="kvpList" class="list"></ul><div class="row"><input id="kvpName" placeholder="KVP set name"> <button class="btn" onclick="saveKVP()">Save</button></div><textarea id="kvpInput" placeholder='{"name": "Chris", "items": ["apple", "banana"]}'></textarea></div><div class="col"><label>Custom CSS (for output)</label><ul id="cssList" class="list"></ul><div class="row"><input id="cssName" placeholder="CSS set name"> <button class="btn" onclick="saveCSS()">Save</button></div><textarea id="cssInput" placeholder="Enter CSS rules here..."></textarea></div></div><div class="output-controls"><label for="formatSelect">Output as:</label> <select id="formatSelect"><option value="html">HTML</option><option value="markdown">Markdown</option><option value="csv">CSV</option><option value="txt">Plain Text</option><option value="pdf">PDF</option></select> <button class="btn" onclick="renderOutput()">Render</button> <button class="btn secondary" id="copyBtn" onclick="copyOutput()">Copy Output</button> <button class="btn secondary" onclick="downloadOutput()">Download</button></div><div id="output" class="output-area"></div><footer class="footer"><div class="footer-content"><div class="footer-info"><span class="app-name">Templatimator</span> <span class="copyright">&copy; <span id="copyright-year">2025</span> <a href="https://github.com/seesee" target="_blank" rel="noopener noreferrer" class="author-link">Chris Carline</a></span></div><div class="footer-links"><a href="https://github.com/seesee/templatimator" target="_blank" rel="noopener noreferrer" class="github-link"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.374 0 0 5.373 0 12 0 17.302 3.438 21.8 8.207 23.387c.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0112 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"/></svg> View on GitHub</a></div></div></footer></div><script src="app.js"></script><script>let t={};if("undefined"!=typeof require)try{t=require("./utils")}catch(t){}function e(e){if(t.parseYAML)return t.parseYAML(e);const n=e.split("\n");let o={},l=null,a=null;for(let t of n)if(t=t.trim(),t&&!t.startsWith("#"))if(t.includes(":")){let[e,...n]=t.split(":");e=e.trim();let c=n.join(":").trim();""===c?(l=e,a=[],o[e]=a):c.startsWith("[")&&c.endsWith("]")?o[e]=c.slice(1,-1).split(",").map(t=>t.trim()):"true"===c||"false"===c?o[e]="true"===c:isNaN(Number(c))?o[e]=c:o[e]=Number(c)}else t.startsWith("-")&&a&&a.push(t.slice(1).trim());return o}function n(t,e){function n(t,e){return t.split(".").reduce((t,e)=>t&&void 0!==t[e]?t[e]:"",e)}return function t(e,o){return(e=(e=e.replace(/{%\s*for\s+(\w+)\s+in\s+([\w.]+)\s*%}([\s\S]*?){%\s*endfor\s*%}/g,(e,l,a,c)=>{const r=n(a,o);return Array.isArray(r)?r.map((e,n)=>{const a=Object.assign({},o);return a[l]=e,a.loop={index:n,index1:n+1},t(c,a)}).join(""):""})).replace(/{%\s*if\s+([\w.]+)\s*%}([\s\S]*?){%\s*endif\s*%}/g,(e,l,a)=>n(l,o)?t(a,o):"")).replace(/{{\s*([\w.]+)\s*}}/g,(t,e)=>{const l=n(e,o);return void 0!==l?l:""})}(t,e)}function o(t){const e=(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).split(/\r?\n/);let n="",o=!1,l="",a=!1,c=!1,r=!1,m="",i="",u=[],s="",d=[];function p(){d.length&&(n+="<p>"+y(d.join(" "))+"</p>",d=[])}function g(){o&&(n+="ul"===l?"</ul>":"</ol>",o=!1,l="")}function f(){a&&(n+="</blockquote>",a=!1)}function h(){r&&(n+="<table><thead><tr>",m.split("|").forEach(t=>{t.trim()&&(n+="<th>"+t.trim()+"</th>")}),n+="</tr></thead><tbody>",u.forEach(t=>{n+="<tr>",t.split("|").forEach(t=>{t.trim()&&(n+="<td>"+t.trim()+"</td>")}),n+="</tr>"}),n+="</tbody></table>",r=!1,m="",i="",u=[])}function y(t){return(t=(t=(t=(t=t.replace(/`([^`]+)`/g,(t,e)=>"<code>"+e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</code>")).replace(/\*\*\*([^\*]+)\*\*\*/g,"<b><i>$1</i></b>")).replace(/\*\*([^\*]+)\*\*/g,"<b>$1</b>")).replace(/\*([^\*]+)\*/g,"<i>$1</i>")).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2">$1</a>')}for(let t=0;t<e.length;t++){let E=e[t];if(/^```/.test(E)){c?(c=!1,n+="</code></pre>"):(p(),g(),f(),h(),c=!0,s=E.replace(/^```/,"").trim(),n+="<pre><code>");continue}if(c){n+=E.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"\n";continue}if(/^\|(.+)\|$/.test(E)){r?u.push(E):(p(),g(),f(),r=!0,m=E,u=[]);continue}if(r&&/^(\|[\s:-]+\|)$/.test(E)){i=E;continue}if(r&&!/^\|(.+)\|$/.test(E)&&h(),/^> /.test(E)){p(),g(),a||(a=!0,n+="<blockquote>"),n+=y(E.replace(/^> /,""))+" ";continue}if(f(),/^\s*[-*+] /.test(E)){p(),o&&"ul"===l||(g(),o=!0,l="ul",n+="<ul>"),n+="<li>"+y(E.replace(/^\s*[-*+] /,""))+"</li>";continue}if(/^\s*\d+\. /.test(E)){p(),o&&"ol"===l||(g(),o=!0,l="ol",n+="<ol>"),n+="<li>"+y(E.replace(/^\s*\d+\. /,""))+"</li>";continue}let v=E.match(/^(#{1,6})\s+(.*)$/);v?(p(),g(),n+=`<h${v[1].length}>${y(v[2])}</h${v[1].length}>`):/^---+$/.test(E)?(p(),g(),n+="<hr />"):/^\s*$/.test(E)?(p(),g(),f(),h()):d.push(E.trim())}return p(),g(),f(),h(),n=n.replace(/>\s+</g,"><"),n}const l="standalone_templates",a="standalone_kvps",c="standalone_css";function r(){return JSON.parse(localStorage.getItem(l)||"[]")}function m(t){localStorage.setItem(l,JSON.stringify(t))}function i(){return JSON.parse(localStorage.getItem(a)||"[]")}function u(t){localStorage.setItem(a,JSON.stringify(t))}function s(){return JSON.parse(localStorage.getItem(c)||"[]")}function d(t){localStorage.setItem(c,JSON.stringify(t))}let p=null,f=null,g=null;const h=[{name:"Markdown List",content:"# Shopping List for {{ name }}\n{% for item in items %}\n- {{ item }}\n{% endfor %}"},{name:"CSV Table",content:"name, item\n{% for item in items %}\n{{ name }}, {{ item }}\n{% endfor %}"},{name:"HTML Table",content:'<table border="1">\n  <tr><th>Name</th><th>Item</th></tr>\n  {% for item in items %}\n  <tr><td>{{ name }}</td><td>{{ item }}</td></tr>\n  {% endfor %}\n</table>'}],y=[{name:"Example",content:'{\n  "name": "Chris",\n  "items": ["apple", "banana", "carrot"]\n}'}],v=[{name:"Templatimator Example",content:"/* All output is wrapped in .templatimator-output */\n.templatimator-output {\n  font-family: 'Segoe UI', Arial, sans-serif;\n  color: #222;\n  background: #fff;\n  padding: 1em;\n  border-radius: 8px;\n  max-width: 700px;\n  margin: 0 auto;\n}\n.templatimator-output h1, .templatimator-output h2, .templatimator-output h3 {\n  font-family: 'Segoe UI', Arial, sans-serif;\n  color: #2d7ff9;\n  margin-top: 1.2em;\n  margin-bottom: 0.5em;\n}\n.templatimator-output ul, .templatimator-output ol {\n  margin: 0 0 1em 2em;\n  padding: 0;\n}\n.templatimator-output li {\n  margin: 0.2em 0;\n}\n.templatimator-output blockquote {\n  border-left: 3px solid #b3c7e6;\n  margin: 0.5em 0;\n  padding: 0.5em 1em;\n  background: #f0f4fa;\n  color: #555;\n}\n.templatimator-output pre {\n  background: #eaeaea;\n  padding: 0.7em;\n  border-radius: 4px;\n  overflow-x: auto;\n}\n.templatimator-output code {\n  background: #eaeaea;\n  padding: 0.1em 0.3em;\n  border-radius: 3px;\n  font-size: 0.95em;\n}\n.templatimator-output table {\n  border-collapse: collapse;\n  margin: 1em 0;\n}\n.templatimator-output th, .templatimator-output td {\n  border: 1px solid #bbb;\n  padding: 0.3em 0.7em;\n}\n.templatimator-output th {\n  background: #f0f4fa;\n}\n.templatimator-output p {\n  margin: 0.5em 0 1em 0;\n}\n"}];function I(){0===r().length&&m(h),0===i().length&&u(y),0===s().length&&d(v),E(),k(),C(),document.getElementById("formatSelect").value="html",M()}function E(){const t=document.getElementById("templateList"),e=r();t.innerHTML="",e.forEach((e,n)=>{const o=document.createElement("li");o.textContent=e.name,p===n&&o.classList.add("selected"),o.onclick=()=>b(n);const l=document.createElement("button");l.textContent="✕",l.className="del",l.onclick=t=>{t.stopPropagation(),x(n)},o.appendChild(l),t.appendChild(o)})}function b(t){p=t;const e=r();document.getElementById("templateInput").value=e[t].content,document.getElementById("templateName").value=e[t].name,E(),M()}function B(){const t=document.getElementById("templateName").value.trim(),e=document.getElementById("templateInput").value;if(!t)return alert("Template name required");let n=r();null!==p?n[p]={name:t,content:e}:(n.push({name:t,content:e}),p=n.length-1),m(n),E(),M()}function x(t){let e=r();e.splice(t,1),m(e),p===t&&(p=null,document.getElementById("templateInput").value="",document.getElementById("templateName").value=""),E(),M()}function k(){const t=document.getElementById("kvpList"),e=i();t.innerHTML="",e.forEach((e,n)=>{const o=document.createElement("li");o.textContent=e.name,f===n&&o.classList.add("selected"),o.onclick=()=>L(n);const l=document.createElement("button");l.textContent="✕",l.className="del",l.onclick=t=>{t.stopPropagation(),N(n)},o.appendChild(l),t.appendChild(o)})}function L(t){f=t;const e=i();document.getElementById("kvpInput").value=e[t].content,document.getElementById("kvpName").value=e[t].name,k(),M()}function S(){const t=document.getElementById("kvpName").value.trim(),e=document.getElementById("kvpInput").value;if(!t)return alert("KVP set name required");let n=i();null!==f?n[f]={name:t,content:e}:(n.push({name:t,content:e}),f=n.length-1),u(n),k(),M()}function N(t){let e=i();e.splice(t,1),u(e),f===t&&(f=null,document.getElementById("kvpInput").value="",document.getElementById("kvpName").value=""),k(),M()}function C(){const t=document.getElementById("cssList"),e=s();t.innerHTML="",e.forEach((e,n)=>{const o=document.createElement("li");o.textContent=e.name,g===n&&o.classList.add("selected"),o.onclick=()=>w(n);const l=document.createElement("button");l.textContent="✕",l.className="del",l.onclick=t=>{t.stopPropagation(),T(n)},o.appendChild(l),t.appendChild(o)})}function w(t){g=t;const e=s();document.getElementById("cssInput").value=e[t].content,document.getElementById("cssName").value=e[t].name,C(),M()}function $(){const t=document.getElementById("cssName").value.trim(),e=document.getElementById("cssInput").value;if(!t)return alert("CSS set name required");let n=s();null!==g?n[g]={name:t,content:e}:(n.push({name:t,content:e}),g=n.length-1),d(n),C(),M()}function T(t){let e=s();e.splice(t,1),d(e),g===t&&(g=null,document.getElementById("cssInput").value="",document.getElementById("cssName").value=""),C(),M()}function O(){const t=document.getElementById("kvpInput").value.trim();if(!t)return{};try{return t.startsWith("{")||t.startsWith("[")?JSON.parse(t):e(t)}catch(t){return{}}}function M(){const t=document.getElementById("templateInput").value,e=O(),l=document.getElementById("formatSelect").value,a=s(),c=null!==g&&a[g]?a[g].content:"";let r="",m="";try{r=n(t,e)}catch(t){r="Error rendering template: "+t.message}if("html"===l||"pdf"===l){let e;e=/^# /.test(t)||/^- /.test(t)||/\n- /.test(t)||/\n\d+\. /.test(t)?o(r):r,m=`<div class="templatimator-output">${e}</div>`+(c?`<style>${c}</style>`:"")}else"markdown"===l?m=`<pre>${J(r)}</pre>`:"csv"!==l&&"txt"!==l||(m=`<pre>${J(r)}</pre>`);document.getElementById("output").innerHTML=m}function A(){const t=document.getElementById("formatSelect").value,e=document.getElementById("output"),n=document.getElementById("copyBtn");let o=!1;if("html"===t||"pdf"===t)try{const t=document.createRange();t.selectNodeContents(e);const n=window.getSelection();n.removeAllRanges(),n.addRange(t),document.execCommand("copy"),n.removeAllRanges(),o=!0}catch(t){o=!1}else{const l=e.innerText;if(navigator.clipboard)return void navigator.clipboard.writeText(l).then(()=>{o=!0,q(n,!0)},()=>{o=!1,q(n,!1)});try{const t=document.createElement("textarea");t.value=l,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),o=!0}catch(t){o=!1}}q(n,o)}function q(t,e){t.classList.remove("flash-success","flash-fail"),t.offsetWidth,t.classList.add(e?"flash-success":"flash-fail"),setTimeout(()=>{t.classList.remove("flash-success","flash-fail")},500)}function R(){const t=document.getElementById("formatSelect").value,e=document.getElementById("output");let n="",o="text/plain",l="txt";if("html"===t||"pdf"===t?(n=e.innerHTML,o="text/html",l="html"):(n=e.innerText,"csv"===t?(o="text/csv",l="csv"):"markdown"===t&&(o="text/markdown",l="md")),"pdf"===t)return void window.print();const a=new Blob([n],{type:o}),c=document.createElement("a");c.href=URL.createObjectURL(a),c.download="output."+l,document.body.appendChild(c),c.click(),setTimeout(()=>{document.body.removeChild(c),URL.revokeObjectURL(c.href)},100)}function J(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function W(){const t=(new Date).getFullYear(),e=document.getElementById("copyright-year");e&&(e.textContent=2025===t?2025..toString():`2025-${t}`)}document.getElementById("templateInput").addEventListener("input",M),document.getElementById("kvpInput").addEventListener("input",M),document.getElementById("cssInput").addEventListener("input",M),document.getElementById("formatSelect").addEventListener("change",M),document.addEventListener("DOMContentLoaded",()=>{I(),W()})</script></body></html>